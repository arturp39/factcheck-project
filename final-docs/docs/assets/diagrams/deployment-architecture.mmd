---
config:
  layout: elk
---
flowchart LR
  subgraph CloudRun["Cloud Run"]
    BE["backend"]
    COL["news-collector"]
    NLP["nlp-service"]
  end

  subgraph CloudSQL["Cloud SQL"]
    DB_BE["backend DB"]
    DB_COL["collector DB"]
  end

  subgraph VM["Compute Engine VM"]
    W["Weaviate (Docker)"]
  end

  subgraph Managed["GCP Managed Services"]
    SCH["Cloud Scheduler"]
    TASKS["Cloud Tasks"]
    VAI["Vertex AI"]
  end

  subgraph External["External APIs"]
    NEWS["NewsAPI / RSS"]
    MBFC["MBFC RapidAPI"]
  end

  BE <--> DB_BE
  COL <--> DB_COL
  BE <--> W
  COL <--> W
  BE <--> NLP
  NLP --> VAI
  BE --> VAI
  COL --> NEWS
  COL -- "sync bias metadata" --> MBFC
  SCH --> COL
  COL --> TASKS
  TASKS --> COL
